\doxysection{Columns\+Manager.\+py}
\hypertarget{_columns_manager_8py_source}{}\label{_columns_manager_8py_source}\index{/Users/michellmonroy/Documents/dev-\/glider/glider/src/importer/ColumnsManager.py@{/Users/michellmonroy/Documents/dev-\/glider/glider/src/importer/ColumnsManager.py}}
\mbox{\hyperlink{_columns_manager_8py}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00001}\mbox{\hyperlink{namespaceimporter_1_1_columns_manager}{00001}}\ \textcolor{keyword}{from}\ TemplateManager\ \textcolor{keyword}{import}\ TemplateManager\ }
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00002}00002\ \textcolor{keyword}{from}\ ErrorHandler\ \textcolor{keyword}{import}\ *}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00003}00003\ \textcolor{comment}{\#\ from\ copy\ import\ deepcopy}}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00004}00004\ \textcolor{keyword}{from}\ pandas\ \textcolor{keyword}{import}\ DataFrame,\ to\_datetime}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00005}00005\ }
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00006}\mbox{\hyperlink{classimporter_1_1_columns_manager_1_1get___d_f__otto}{00006}}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classimporter_1_1_columns_manager_1_1get___d_f__otto}{get\_DF\_otto}}:}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00007}00007\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00008}00008\ \textcolor{stringliteral}{\ \ \ \ Builds\ a\ homogenized\ dataframe\ according\ to\ ottomapping\ field\ of\ each\ format\ in\ out\ database\ }}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00009}00009\ \textcolor{stringliteral}{\ \ \ \ Checks\ each\ ftype\ and\ applies\ different\ instructions\ depending\ of\ ftype:}}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00010}00010\ \textcolor{stringliteral}{\ \ \ \ ftype\ =\ header:\ Creates\ a\ new\ columns\ using\ field\ "{}name"{}.}}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00011}00011\ \textcolor{stringliteral}{\ \ \ \ ftype\ =\ fixed\_value:\ Creates\ a\ new\ column\ which\ contains\ only\ field\ "{}value"{}.}}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00012}00012\ \textcolor{stringliteral}{\ \ \ \ ftype\ =\ custom\_code:\ Creates\ a\ new\ column\ using\ the\ column\ given\ by\ format\_type.}}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00013}00013\ \textcolor{stringliteral}{\ \ \ \ ftype\ =\ ignore:\ Creates\ a\ empty\ column\ using\ field\ "{}name"{}.}}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00014}00014\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00015}00015\ }
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00016}\mbox{\hyperlink{classimporter_1_1_columns_manager_1_1get___d_f__otto_a4d125694a0e6bebcc0f4c7c66c10e201}{00016}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classimporter_1_1_columns_manager_1_1get___d_f__otto_a4d125694a0e6bebcc0f4c7c66c10e201}{ftypes}}(self,\ df,\ ftype,\ Format,\ filename):}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00017}00017\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00018}00018\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Maps\ the\ columns\ from\ almost\ any\ template\ to\ otto\ template\ }}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00019}00019\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00020}00020\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Args:}}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00021}00021\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ df\ (pandas\ dataframe):\ usage\ report\ loaded\ as\ dataframe}}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00022}00022\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ ftype\ (list):\ a\ list\ of\ each\ column\ info}}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00023}00023\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ Format\ (str):\ template\ format}}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00024}00024\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ filename\ (str):\ current\ filename}}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00025}00025\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns:\ df\_otto\ (pandas\ dataframe)}}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00026}00026\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00027}00027\ \ \ \ \ \ \ \ \ df\_otto\ =\ DataFrame()}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00028}00028\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ ftype:}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00029}00029\ \ \ \ \ \ \ \ \ \ \ \ \ print(i)}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00030}00030\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ i[\textcolor{stringliteral}{"{}ftype"{}}]\ ==\ \textcolor{stringliteral}{"{}header"{}}:}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00031}00031\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ i[\textcolor{stringliteral}{"{}name"{}}]\ ==\ \textcolor{stringliteral}{"{}date"{}}\ \textcolor{keywordflow}{and}\ df[i[\textcolor{stringliteral}{"{}value"{}}].lower()].dtype\ ==\ int:}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00032}00032\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ df[i[\textcolor{stringliteral}{"{}value"{}}].lower()]\ =\ to\_datetime(df[i[\textcolor{stringliteral}{"{}value"{}}].lower()],\ format=\textcolor{stringliteral}{'\%Y\%m\%d'})}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00033}00033\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ df\_otto[i[\textcolor{stringliteral}{"{}name"{}}]]\ =\ df[i[\textcolor{stringliteral}{"{}value"{}}].lower()].astype(i[\textcolor{stringliteral}{"{}dtype"{}}])}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00034}00034\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ i[\textcolor{stringliteral}{"{}ftype"{}}]\ ==\ \textcolor{stringliteral}{"{}fixed\_value"{}}:}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00035}00035\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ df\_otto[i[\textcolor{stringliteral}{"{}name"{}}]]\ =\ i[\textcolor{stringliteral}{"{}value"{}}]}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00036}00036\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ i[\textcolor{stringliteral}{"{}ftype"{}}]\ ==\ \textcolor{stringliteral}{"{}custom\_code"{}}:}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00037}00037\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ i[\textcolor{stringliteral}{"{}name"{}}]\ ==\ \textcolor{stringliteral}{"{}date"{}}:}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00038}00038\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ date\ =\ TemplateManager.getDate(df,\ Format,\ filename)}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00039}00039\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ df\_otto[i[\textcolor{stringliteral}{"{}name"{}}]]\ =\ date}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00040}00040\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ df\_otto[i[\textcolor{stringliteral}{"{}name"{}}]]\ =\ df\_otto[i[\textcolor{stringliteral}{"{}name"{}}]].astype(\textcolor{stringliteral}{"{}datetime64[ns]"{}})}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00041}00041\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00042}00042\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ TemplateManager.getType(df,\ Format,\ filename)}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00043}00043\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ df\_otto[i[\textcolor{stringliteral}{"{}name"{}}]]\ =\ df[i[\textcolor{stringliteral}{"{}value"{}}].lower()]}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00044}00044\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ i[\textcolor{stringliteral}{"{}ftype"{}}]\ ==\ \textcolor{stringliteral}{"{}ignore"{}}:}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00045}00045\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ df\_otto[i[\textcolor{stringliteral}{"{}name"{}}]]\ =\ \textcolor{keywordtype}{None}\ \ }
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00046}00046\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ TemplateManager.set\_full\_type(df\_otto)\ }}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00047}00047\ \ \ \ \ \ \ \ \ df\_otto[\textcolor{stringliteral}{"{}full\_type"{}}]\ =\ df\_otto.apply(\textcolor{keyword}{lambda}\ Row:\ TemplateManager.full\_type(Row[\textcolor{stringliteral}{"{}type"{}}]),\ axis=1)\ }
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00048}00048\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ df\_otto}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00049}00049\ }
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00050}\mbox{\hyperlink{classimporter_1_1_columns_manager_1_1get___d_f__otto_a0511c1e6478357ce131e2892ee3352b9}{00050}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classimporter_1_1_columns_manager_1_1get___d_f__otto_a0511c1e6478357ce131e2892ee3352b9}{currency\_type}}(self,\ currency\_col,\ exchange):}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00051}00051\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00052}00052\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Gives\ a\ value\ to\ each\ currency\ }}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00053}00053\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00054}00054\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Args:}}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00055}00055\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ currency\_col\ (pandas\ Series):\ column\ assigned\ to\ currency}}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00056}00056\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ exchange\ (dict):\ it\ contains\ all\ exchange\ rates\ for\ current\ report}}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00057}00057\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns:\ exchange\ (float)}}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00058}00058\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00059}00059\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ exchange[currency\_col]}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00060}00060\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00061}\mbox{\hyperlink{classimporter_1_1_columns_manager_1_1get___d_f__otto_ac8c48a835d1430fba61b65419800bad5}{00061}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classimporter_1_1_columns_manager_1_1get___d_f__otto_ac8c48a835d1430fba61b65419800bad5}{add\_exchange}}(self,\ df,\ exchange):}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00062}00062\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00063}00063\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Adds\ exchange\_rate\ and\ total\_local\ columns\ to\ current\ dataframe}}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00064}00064\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00065}00065\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Args:}}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00066}00066\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ df\ (pandas\ dataframe):\ usage\ report\ loaded\ as\ dataframe}}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00067}00067\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ exchange\ (dict):\ it\ contains\ all\ exchange\ rates\ for\ current\ report}}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00068}00068\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns:\ df\ (pandas\ dataframe)}}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00069}00069\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00070}00070\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00071}00071\ \ \ \ \ \ \ \ \ \ \ \ \ df[\textcolor{stringliteral}{"{}exchange\_rate"{}}]\ =\ df.apply(\textcolor{keyword}{lambda}\ Row:\ self.\mbox{\hyperlink{classimporter_1_1_columns_manager_1_1get___d_f__otto_a0511c1e6478357ce131e2892ee3352b9}{currency\_type}}(Row[\textcolor{stringliteral}{'currency'}],\ exchange),\ axis=1)}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00072}00072\ \ \ \ \ \ \ \ \ \ \ \ \ df[\textcolor{stringliteral}{"{}total\_local"{}}]\ =\ df[\textcolor{stringliteral}{"{}exchange\_rate"{}}]*df[\textcolor{stringliteral}{"{}total\_foreign"{}}]}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00073}00073\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ df}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00074}00074\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ Exception:}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00075}00075\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}There\ are\ currencies\ not\ found\ in\ your\ file,\ please\ check\ currencies"{}}}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00076}00076\ }
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00077}\mbox{\hyperlink{classimporter_1_1_columns_manager_1_1get___d_f__otto_a7b3ac04a8a2f8a8934c307b42b3d0b2e}{00077}}\ \ \ \ \ \textcolor{keyword}{def\ }\mbox{\hyperlink{classimporter_1_1_columns_manager_1_1get___d_f__otto_a7b3ac04a8a2f8a8934c307b42b3d0b2e}{discount}}(self,\ df):}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00078}00078\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00079}00079\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Makes\ a\ discount\ for\ selected\ templates}}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00080}00080\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00081}00081\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Args:}}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00082}00082\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ \ \ \ \ df\ (pandas\ dataframe):\ usage\ report\ loaded\ as\ dataframe}}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00083}00083\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Returns:\ df\ (pandas\ dataframe)}}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00084}00084\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00085}00085\ \ \ \ \ \ \ \ \ df[\textcolor{stringliteral}{"{}total\_local"{}}]\ =\ df[\textcolor{stringliteral}{"{}total\_local"{}}]-\/(df[\textcolor{stringliteral}{"{}total\_local"{}}]*0.015)}
\DoxyCodeLine{\Hypertarget{_columns_manager_8py_source_l00086}00086\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ df}

\end{DoxyCode}
