\doxysection{Upload\+Reports.\+py}
\hypertarget{_upload_reports_8py_source}{}\label{_upload_reports_8py_source}\index{/Users/michellmonroy/Documents/dev-\/glider/glider/src/report\_generation/UploadReports.py@{/Users/michellmonroy/Documents/dev-\/glider/glider/src/report\_generation/UploadReports.py}}
\mbox{\hyperlink{_upload_reports_8py}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{_upload_reports_8py_source_l00001}\mbox{\hyperlink{namespace_upload_reports}{00001}}\ \textcolor{keyword}{import}\ os}
\DoxyCodeLine{\Hypertarget{_upload_reports_8py_source_l00002}00002\ \textcolor{keyword}{import}\ boto3}
\DoxyCodeLine{\Hypertarget{_upload_reports_8py_source_l00003}00003\ \textcolor{keyword}{import}\ json}
\DoxyCodeLine{\Hypertarget{_upload_reports_8py_source_l00004}00004\ \textcolor{keyword}{from}\ dotenv\ \textcolor{keyword}{import}\ load\_dotenv}
\DoxyCodeLine{\Hypertarget{_upload_reports_8py_source_l00005}00005\ load\_dotenv()}
\DoxyCodeLine{\Hypertarget{_upload_reports_8py_source_l00006}00006\ }
\DoxyCodeLine{\Hypertarget{_upload_reports_8py_source_l00007}\mbox{\hyperlink{namespace_upload_reports_ab46f15b65eb438ce47a142af6c22c765}{00007}}\ ACCESS\_ID\ =\ os.environ.get(\textcolor{stringliteral}{"{}AWS\_KEY\_ID"{}})}
\DoxyCodeLine{\Hypertarget{_upload_reports_8py_source_l00008}\mbox{\hyperlink{namespace_upload_reports_a84a82c43724b54d2cb11fda287741013}{00008}}\ ACCESS\_KEY\ =\ os.environ.get(\textcolor{stringliteral}{"{}AWS\_KEY\_SECRET"{}})}
\DoxyCodeLine{\Hypertarget{_upload_reports_8py_source_l00009}\mbox{\hyperlink{namespace_upload_reports_add8ace354ff225909eadc2abd41ab2ca}{00009}}\ function\_name\ =\ os.environ.get(\textcolor{stringliteral}{"{}LAMBDA\_FUNCTION"{}})\ \ }
\DoxyCodeLine{\Hypertarget{_upload_reports_8py_source_l00010}\mbox{\hyperlink{namespace_upload_reports_a41cb7f7c78621001a3dca8fe60589076}{00010}}\ s3\_client\ =\ boto3.client(\textcolor{stringliteral}{"{}s3"{}},\ aws\_access\_key\_id=ACCESS\_ID,\ aws\_secret\_access\_key=\ ACCESS\_KEY)}
\DoxyCodeLine{\Hypertarget{_upload_reports_8py_source_l00011}00011\ }
\DoxyCodeLine{\Hypertarget{_upload_reports_8py_source_l00012}\mbox{\hyperlink{namespace_upload_reports_a66e3bc1fae05ab2aad541cdfbbc8ccb3}{00012}}\ \textcolor{keyword}{def\ }\mbox{\hyperlink{namespace_upload_reports_a66e3bc1fae05ab2aad541cdfbbc8ccb3}{create\_presigned\_url}}(bucket,\ object,\ expiration=86400):\textcolor{comment}{\#86400}}
\DoxyCodeLine{\Hypertarget{_upload_reports_8py_source_l00013}00013\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Generate\ a\ presigned\ URL\ to\ share\ an\ S3\ object\ via\ lambda\ invoke}}
\DoxyCodeLine{\Hypertarget{_upload_reports_8py_source_l00014}00014\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{_upload_reports_8py_source_l00015}00015\ \textcolor{stringliteral}{\ \ \ \ Args:}}
\DoxyCodeLine{\Hypertarget{_upload_reports_8py_source_l00016}00016\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ bucket\ (str):\ bucket\ where\ report\ was\ uploaded}}
\DoxyCodeLine{\Hypertarget{_upload_reports_8py_source_l00017}00017\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ object\ (str):\ full\ report\ object\ name\ }}
\DoxyCodeLine{\Hypertarget{_upload_reports_8py_source_l00018}00018\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ expiration\ (int):\ time\ in\ seconds\ for\ the\ presigned\ URL\ to\ remain\ valid}}
\DoxyCodeLine{\Hypertarget{_upload_reports_8py_source_l00019}00019\ \textcolor{stringliteral}{\ \ \ \ Returns:\ response\ (str):\ If\ error,\ returns\ None.}}
\DoxyCodeLine{\Hypertarget{_upload_reports_8py_source_l00020}00020\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{_upload_reports_8py_source_l00021}00021\ \ \ \ \ get\_log\ =\ \textcolor{keyword}{True}\ }
\DoxyCodeLine{\Hypertarget{_upload_reports_8py_source_l00022}00022\ \ \ \ \ function\_params\ =\ \{\ }
\DoxyCodeLine{\Hypertarget{_upload_reports_8py_source_l00023}00023\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}bucket"{}}:\ bucket,\ }
\DoxyCodeLine{\Hypertarget{_upload_reports_8py_source_l00024}00024\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}object"{}}:\ object,\ }
\DoxyCodeLine{\Hypertarget{_upload_reports_8py_source_l00025}00025\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}expiration"{}}:\ expiration\ }
\DoxyCodeLine{\Hypertarget{_upload_reports_8py_source_l00026}00026\ \ \ \ \ \ \ \ \ \}\ \ \ \ }
\DoxyCodeLine{\Hypertarget{_upload_reports_8py_source_l00027}00027\ \ \ \ \ client\ =\ boto3.client(\textcolor{stringliteral}{'lambda'},\ aws\_access\_key\_id=ACCESS\_ID,\ aws\_secret\_access\_key=ACCESS\_KEY,\ region\_name=\textcolor{stringliteral}{"{}eu-\/west-\/2"{}})\ }
\DoxyCodeLine{\Hypertarget{_upload_reports_8py_source_l00028}00028\ \ \ \ \ lambda\_response\ =\ client.invoke(\ }
\DoxyCodeLine{\Hypertarget{_upload_reports_8py_source_l00029}00029\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FunctionName=function\_name,\ }
\DoxyCodeLine{\Hypertarget{_upload_reports_8py_source_l00030}00030\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Payload=json.dumps(function\_params),\ }
\DoxyCodeLine{\Hypertarget{_upload_reports_8py_source_l00031}00031\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ LogType=\textcolor{stringliteral}{'Tail'}\ \textcolor{keywordflow}{if}\ get\_log\ \textcolor{keywordflow}{else}\ \textcolor{stringliteral}{'None'})\ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{_upload_reports_8py_source_l00032}00032\ \ \ \ \ link\_response\ =\ lambda\_response[\textcolor{stringliteral}{'Payload'}].read()\ }
\DoxyCodeLine{\Hypertarget{_upload_reports_8py_source_l00033}00033\ \ \ \ \ link\_response\ =\ link\_response.strip()}
\DoxyCodeLine{\Hypertarget{_upload_reports_8py_source_l00034}00034\ \ \ \ \ link\_response\ =\ json.loads(link\_response)}
\DoxyCodeLine{\Hypertarget{_upload_reports_8py_source_l00035}00035\ \ \ \ \ response\ =\ link\_response[\textcolor{stringliteral}{"{}response"{}}]}
\DoxyCodeLine{\Hypertarget{_upload_reports_8py_source_l00036}00036\ \ \ \ \ \textcolor{keywordflow}{return}\ response}
\DoxyCodeLine{\Hypertarget{_upload_reports_8py_source_l00037}00037\ }
\DoxyCodeLine{\Hypertarget{_upload_reports_8py_source_l00038}\mbox{\hyperlink{namespace_upload_reports_a561fba467173f7f2009da404a18be6b1}{00038}}\ \textcolor{keyword}{def\ }upload\_files\_s3(bucket,\ s3\_path,\ local\_path,\ file):}
\DoxyCodeLine{\Hypertarget{_upload_reports_8py_source_l00039}00039\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{_upload_reports_8py_source_l00040}00040\ \textcolor{stringliteral}{\ \ \ \ Uploads\ all\ files\ to\ s3\ path\ defined\ previously}}
\DoxyCodeLine{\Hypertarget{_upload_reports_8py_source_l00041}00041\ \textcolor{stringliteral}{}}
\DoxyCodeLine{\Hypertarget{_upload_reports_8py_source_l00042}00042\ \textcolor{stringliteral}{\ \ \ \ Args:}}
\DoxyCodeLine{\Hypertarget{_upload_reports_8py_source_l00043}00043\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ local\_path\ (str):\ Root\ path\ where\ is\ saved\ files}}
\DoxyCodeLine{\Hypertarget{_upload_reports_8py_source_l00044}00044\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ files\ (str):\ File\ to\ upload}}
\DoxyCodeLine{\Hypertarget{_upload_reports_8py_source_l00045}00045\ \textcolor{stringliteral}{\ \ \ \ Returns:\ Nothing.}}
\DoxyCodeLine{\Hypertarget{_upload_reports_8py_source_l00046}00046\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{\Hypertarget{_upload_reports_8py_source_l00047}00047\ \ \ \ \ full\_path\ =\ local\_path+file}
\DoxyCodeLine{\Hypertarget{_upload_reports_8py_source_l00048}00048\ \ \ \ \ s3\_full\_path\ =\ s3\_path+file}
\DoxyCodeLine{\Hypertarget{_upload_reports_8py_source_l00049}00049\ \ \ \ \ s3\_client.upload\_file(full\_path,\ bucket,\ s3\_full\_path)}
\DoxyCodeLine{\Hypertarget{_upload_reports_8py_source_l00050}00050\ \ \ \ \ url\ =\ \mbox{\hyperlink{namespace_upload_reports_a66e3bc1fae05ab2aad541cdfbbc8ccb3}{create\_presigned\_url}}(bucket,\ s3\_path+file)}
\DoxyCodeLine{\Hypertarget{_upload_reports_8py_source_l00051}00051\ \ \ \ \ \textcolor{keywordflow}{return}\ url,\ s3\_full\_path}

\end{DoxyCode}
